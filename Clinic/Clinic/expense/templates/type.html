{% extends 'base.html' %}
{% block content %}
{% if request.GET.error %}
    <p>{{request.GET.error}}</p>
{% endif %}

{% if status != 'unknown' %}
    <!--{{status}}
    {{error}}
    {{data}}-->
{% endif %}
<script language="JavaScript">
    $( function() {

        $( "#datepicker" ).datepicker({ dateFormat: 'yy-mm-dd',
        shortYearCutoff: 1,
        changeMonth: true,
        changeYear: true,
        minDate: "-99Y",
         yearRange: "1900:2030"  });
      } );

      function add_type(){
        data = {
                    'name': document.getElementById('name').value
        };
        $.ajax({
          url: "/medicine/type/add/",
          type: "get", //send it through get method
          data: data,
          success: function(response) {
            console.log("success");
            if(response.status == 'failure')
                global_alert(response.error, 1000);
            else
                window.location = "";
          },
          error: function(response) {
            global_alert("Some Error.", 1000);
          }
        });
      }

      function delete_type(idmedicine_type){
        data = {
                    'idmedicine_type': idmedicine_type
        };
        $.ajax({
          url: "/medicine/type/delete/",
          type: "get", //send it through get method
          data: data,
          success: function(response) {
            console.log("success");
            if(response.status == 'failure')
                global_alert(response.error, 1000);
            else
                window.location = "";
          },
          error: function(response) {
            global_alert("Some Error.", 1000);
          }
        });
      }
</script>

<h3>Medicine Administration</h3>
<div id="medicine_type">
    <a href="/medicine/type/">Manage Categories</a>
</div>

<div id="medicine_type_mapping">
    <a href="/medicine/mapping/">Category-Items Mapping</a>
</div>

<div id="medicine_add">
    <a href="/medicine/add_items/">Add Medicines/Items</a>
</div>

<div><h3>Categories</h3></div>
<div onclick="$('#add_type').fadeToggle()"><b>Add New +</b></div>
<div>
    <table class="rbstable">
        <thead>
        <tr>
            <td>ID</td>
            <td>Type</td>
            <td>Delete</td>
        </tr>
        </thead>
        <tr style="display:none;" id="add_type"><td colspan="3">
                <input type="text" id="name" value="">
                <button type="button" onclick="add_type()" class="greenbuttons">Add</button>
        </td></tr>
        {% for record in data %}
        <tr>
            <td>{{record.idmedicine_type}}</td>
            <td>{{record.name}}</td>
            <td>
                <input type="hidden" id="idmedicine_type" value="{{record.idmedicine_type}}">
                <button type="button" onclick="delete_type('{{record.idmedicine_type}}')" class="greenbuttons">Delete</button>
            </td>
        </tr>
        {% endfor %}
    </table>
</div>
{% endblock %}